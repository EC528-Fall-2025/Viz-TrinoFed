import{j as e}from"./jsx-runtime-BjG_zV1W.js";import{a as z}from"./fixtures-BzLkDzPP.js";const M=({query:o})=>{var y;const p=t=>{if(!t||t===0)return null;const i=t/1024;if(i<1024)return`${i.toFixed(2)} KB`;const a=i/1024;return a<1024?`${a.toFixed(2)} MB`:`${(a/1024).toFixed(2)} GB`},x=t=>!t||t===0?null:t.toLocaleString(),f=t=>t?new Date(t).toLocaleString():null,w=(t,i)=>{if(!t||!i)return null;const a=new Date(t),d=new Date(i).getTime()-a.getTime();return d<1e3?`${d}ms`:`${(d/1e3).toFixed(2)}s`},s=(t=>{const i={};let a=0,n=0,d=0,c=0,g=0,h=0,u=0;t.forEach(r=>{r.cpuTimeMs&&(a+=r.cpuTimeMs),r.wallTimeMs&&(n+=r.wallTimeMs),r.queuedTimeMs&&(d+=r.queuedTimeMs),r.peakMemoryBytes&&r.peakMemoryBytes>c&&(c=r.peakMemoryBytes),r.totalRows&&(g=r.totalRows),r.totalBytes&&(h=r.totalBytes),r.completedSplits&&(u=r.completedSplits)}),a>0&&(i.cpuTime=a),n>0&&(i.wallTime=n),d>0&&(i.queuedTime=d),c>0&&(i.peakMemory=c),g>0&&(i.totalRows=g),h>0&&(i.totalBytes=h),u>0&&(i.completedSplits=u);const B=[...new Set(t.map(r=>r.catalog).filter(Boolean))],j=[...new Set(t.map(r=>r.schema).filter(Boolean))];return B.length>0&&(i.catalogs=B),j.length>0&&(i.schemas=j),i})(o.events||[]),R=w(o.startTime,o.endTime),l=(t,i,a="â€¢")=>i?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px",padding:"4px 0",borderBottom:"1px solid rgba(0,0,0,0.05)"},children:[e.jsxs("span",{style:{color:"#6c757d",fontSize:"12px"},children:[e.jsx("span",{style:{marginRight:"6px"},children:a}),t]}),e.jsx("span",{style:{fontWeight:"bold",fontSize:"12px",color:"#212529"},children:i})]}):null;return e.jsxs("div",{style:{position:"absolute",top:10,left:10,zIndex:10,backgroundColor:"white",padding:"16px 20px",borderRadius:"12px",boxShadow:"0 4px 16px rgba(0,0,0,0.15)",maxWidth:"420px",maxHeight:"85vh",overflow:"auto",fontSize:"13px",borderLeft:`5px solid ${o.state==="FINISHED"?"#51cf66":o.errorMessage?"#ff6b6b":o.state==="RUNNING"?"#ffd43b":"#74c0fc"}`},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"12px",fontSize:"18px",color:"#212529",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{children:"ðŸ“Š"}),e.jsx("span",{children:"Query Metrics"})]}),e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("span",{style:{color:o.state==="FINISHED"?"#2b8a3e":o.errorMessage?"#c92a2a":o.state==="RUNNING"?"#f08c00":"#1971c2",fontWeight:"bold",backgroundColor:o.state==="FINISHED"?"#d3f9d8":o.errorMessage?"#ffe3e3":o.state==="RUNNING"?"#fff3bf":"#d0ebff",padding:"6px 12px",borderRadius:"6px",fontSize:"13px",display:"inline-block"},children:o.state})}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:"Basic Information"}),l("Query ID",o.queryId,"ðŸ”‘"),l("User",o.user,"ðŸ‘¤"),l("Event Count",((y=o.events)==null?void 0:y.length)||0,"ðŸ“"),l("Start Time",f(o.startTime),"ðŸ•"),l("End Time",f(o.endTime),"ðŸ•‘"),l("Duration",R,"â±ï¸")]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:"Performance Metrics"}),l("Total Execution",o.totalExecutionTime?`${o.totalExecutionTime}ms`:null,"â±ï¸"),l("CPU Time",s.cpuTime?`${s.cpuTime}ms`:null,"ðŸ–¥ï¸"),l("Wall Time",s.wallTime?`${s.wallTime}ms`:null,"â°"),l("Queued Time",s.queuedTime?`${s.queuedTime}ms`:null,"â³"),l("Peak Memory",p(s.peakMemory),"ðŸ§ ")]}),(s.totalRows||s.totalBytes||s.completedSplits)&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:"Data Metrics"}),l("Total Rows",x(s.totalRows),"ðŸ“Š"),l("Total Data",p(s.totalBytes),"ðŸ’¾"),l("Completed Splits",x(s.completedSplits),"âœ‚ï¸")]}),(s.catalogs||s.schemas)&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:"Data Sources"}),s.catalogs&&e.jsxs("div",{style:{marginBottom:"6px"},children:[e.jsx("div",{style:{color:"#6c757d",fontSize:"11px",marginBottom:"4px"},children:"ðŸ“š Catalogs"}),e.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:s.catalogs.map((t,i)=>e.jsx("span",{style:{backgroundColor:"#e7f5ff",color:"#1971c2",padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"600"},children:t},i))})]}),s.schemas&&e.jsxs("div",{style:{marginBottom:"6px"},children:[e.jsx("div",{style:{color:"#6c757d",fontSize:"11px",marginBottom:"4px"},children:"ðŸ—‚ï¸ Schemas"}),e.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:s.schemas.map((t,i)=>e.jsx("span",{style:{backgroundColor:"#f3f0ff",color:"#5f3dc4",padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"600"},children:t},i))})]})]}),o.query&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:"SQL Query"}),e.jsx("div",{style:{fontSize:"11px",fontFamily:"monospace",backgroundColor:"#f8f9fa",padding:"10px 12px",borderRadius:"6px",maxHeight:"120px",overflow:"auto",border:"1px solid #dee2e6",color:"#212529",lineHeight:"1.5"},children:o.query})]}),o.errorMessage&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#c92a2a",borderBottom:"2px solid #ffe3e3",paddingBottom:"6px"},children:"âš ï¸ Error Details"}),e.jsx("div",{style:{backgroundColor:"#ffe3e3",color:"#c92a2a",padding:"10px",borderRadius:"6px",fontSize:"12px",borderLeft:"4px solid #c92a2a"},children:o.errorMessage})]}),o.events&&o.events.length>0&&e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsxs("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"10px",color:"#495057",borderBottom:"2px solid #e9ecef",paddingBottom:"6px"},children:["Event Timeline (",o.events.length,")"]}),o.events.map((t,i)=>e.jsxs("div",{style:{marginBottom:"10px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"6px",borderLeft:`4px solid ${t.state==="FINISHED"?"#51cf66":t.state==="FAILED"?"#ff6b6b":t.state==="RUNNING"?"#ffd43b":"#74c0fc"}`},children:[e.jsxs("div",{style:{fontWeight:"bold",fontSize:"12px",color:"#212529",marginBottom:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:t.eventType}),e.jsx("span",{style:{fontSize:"11px",backgroundColor:"white",padding:"2px 6px",borderRadius:"4px",fontWeight:"normal",color:"#6c757d"},children:t.state})]}),e.jsx("div",{style:{fontSize:"10px",color:"#868e96",marginBottom:"6px"},children:f(t.timestamp)}),e.jsxs("div",{style:{fontSize:"11px",color:"#495057"},children:[t.cpuTimeMs&&e.jsxs("div",{children:["CPU: ",t.cpuTimeMs,"ms"]}),t.wallTimeMs&&e.jsxs("div",{children:["Wall: ",t.wallTimeMs,"ms"]}),t.queuedTimeMs&&e.jsxs("div",{children:["Queued: ",t.queuedTimeMs,"ms"]}),t.totalRows&&e.jsxs("div",{children:["Rows: ",x(t.totalRows)]}),t.totalBytes&&e.jsxs("div",{children:["Data: ",p(t.totalBytes)]}),t.peakMemoryBytes&&e.jsxs("div",{children:["Memory: ",p(t.peakMemoryBytes)]}),t.completedSplits&&e.jsxs("div",{children:["Splits: ",t.completedSplits]}),t.errorMessage&&e.jsxs("div",{style:{color:"#c92a2a",marginTop:"4px",fontWeight:"bold"},children:["Error: ",t.errorMessage]})]})]},i))]})]})};M.__docgenInfo={description:"",methods:[],displayName:"QueryMetricsPanel",props:{query:{required:!0,tsType:{name:"QueryTree"},description:""}}};const k={title:"Components/QueryMetricsPanel",component:M,decorators:[o=>e.jsx("div",{style:{position:"relative",width:"100%",minHeight:"600px",backgroundColor:"#f1f3f5"},children:e.jsx(o,{})})],args:{query:z}},m={};var b,T,S;m.parameters={...m.parameters,docs:{...(b=m.parameters)==null?void 0:b.docs,source:{originalSource:"{}",...(S=(T=m.parameters)==null?void 0:T.docs)==null?void 0:S.source}}};const C=["Default"];export{m as Default,C as __namedExportsOrder,k as default};
